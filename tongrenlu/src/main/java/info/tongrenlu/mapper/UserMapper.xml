<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="info.tongrenlu.mapper.UserMapper">
    
    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO M_USER(
        <trim suffixOverrides=",">
           EMAIL,
           PASSWORD,
           NICKNAME,
        </trim>
        ) VALUES (
        <trim suffixOverrides=",">
            #{email},
            #{password},
            #{nickname},
        </trim>
        )
    </insert>
    
    <select id="fetchBean" useCache="false" resultType="UserBean">
        SELECT
        <trim suffixOverrides=",">
            U.id                    as id,
            U.EMAIL                 as email,
            U.PASSWORD              as password,
            U.NICKNAME              as nickname,
        </trim>
        FROM
            M_USER U
        <where>
            U.DEL_FLG = '0'
        <if test="fingerprint != null">
        AND U.fingerprint = #{fingerprint}
        </if>
        <if test="email != null">
        AND U.EMAIL = #{email}
        </if>
        </where>
    </select>
    
    <update id="update">
        UPDATE
            M_USER
        <set>
        <if test="password != null">
        ,   PASSWORD = #{password}
        </if>
        <if test="fingerprint != null">
        ,   fingerprint = #{fingerprint}
        </if>
        </set>
        <where>
            id = #{id}
        </where>
    </update>
</mapper>